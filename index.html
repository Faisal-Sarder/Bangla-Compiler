<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <title>ржмрж╛ржВрж▓рж╛ ржХржорзНржкрж╛ржЗрж▓рж╛рж░</title>
  <style>
    body {
      font-family: 'Noto Sans Bengali', sans-serif;
      background: #eef1f4;
      padding: 20px;
      max-width: 900px;
      margin: auto;
    }
    textarea {
      width: 100%;
      height: 160px;
      font-size: 16px;
      margin-top: 8px;
      padding: 10px;
      border-radius: 5px;
    }
    button {
      margin: 5px;
      padding: 10px 18px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 15px;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    pre {
      background-color: #111;
      color: #0f0;
      padding: 15px;
      border-radius: 5px;
      white-space: pre-wrap;
    }
    h1,
    h3 {
      color: #333;
    }
  </style>
</head>
<body>

  <h1>ЁЯФд ржмрж╛ржВрж▓рж╛ ржХржорзНржкрж╛ржЗрж▓рж╛рж░</h1>

  <label>тЬНя╕П ржмрж╛ржВрж▓рж╛ C ржХрзЛржб рж▓рж┐ржЦрзБржи:</label>
  <textarea id="banglaCode" placeholder="ржПржЦрж╛ржирзЗ ржмрж╛ржВрж▓рж╛ C ржкрзНрж░рзЛржЧрзНрж░рж╛ржорж┐ржВ ржХрзЛржб рж▓рж┐ржЦрзБржи..."></textarea>

  <label>ЁЯУе ржЗржиржкрзБржЯ ржжрж┐ржи (ржпржжрж┐ ржерж╛ржХрзЗ):</label>
  <textarea id="userInput" placeholder="ржпржжрж┐ ржЗржиржкрзБржЯ ржерж╛ржХрзЗ, ржПржЦрж╛ржирзЗ ржжрж┐ржи... (ржмрж╛ржВрж▓рж╛ рж╕ржВржЦрзНржпрж╛ржУ ржЪрж▓ржмрзЗ)"></textarea>

  <div>
    <button onclick="runBanglaCCode()">тЦ╢я╕П рж░рж╛ржи ржХрж░рзЛ</button>
    <button onclick="clearAll()">ЁЯз╣ ржкрж░рж┐рж╖рзНржХрж╛рж░ ржХрж░рзЛ</button>
  </div>

  <h3>ЁЯУд ржЖржЙржЯржкрзБржЯ:</h3>
  <pre id="output">ржПржЦрж╛ржирзЗ ржЖржЙржЯржкрзБржЯ ржЖрж╕ржмрзЗ...</pre>

  <h3>ЁЯФО рж░рзВржкрж╛ржирзНрждрж░рж┐ржд C ржХрзЛржб:</h3>
  <pre id="debug">...</pre>

  <script>
    const mapC = {
      "рж▓рж┐ржЦрзЛ": "printf",
      "рж╕ржВржЦрзНржпрж╛_ржирж╛ржУ": "scanf",
      "ржпржжрж┐": "if",
      "ржирж╛рж╣рж▓рзЗ": "else",
      "ржЬржирзНржп": "for",
      "ржпрждржХрзНрж╖ржг": "while",
      "ржлрж╛ржВрж╢ржи": "void",
      "ржкрзНрж░рждрзНржпрж╛ржмрж░рзНрждржи": "return",
      "ржкрзВрж░рзНржгрж╕ржВржЦрзНржпрж╛": "int",
      "ржнржЧрзНржирж╛ржВрж╢": "float",
      "ржЪрж░": "char",
      "ржорзВрж▓": "main",
      "рж╕ржорж╛ржи": "==",
      "ржирж╛_рж╕ржорж╛ржи": "!=",
      "ржмржбрж╝": ">",
      "ржЫрзЛржЯ": "<",
      "ржПржмржВ": "&&",
      "ржЕржержмрж╛": "||"
    };

    const banglaDigits = {
      "рзж": "0", "рзз": "1", "рзи": "2", "рзй": "3", "рзк": "4",
      "рзл": "5", "рзм": "6", "рзн": "7", "рзо": "8", "рзп": "9"
    };

    // ржмрж╛ржВрж▓рж╛ ржбрж┐ржЬрж┐ржЯ ржЗржВрж░рзЗржЬрж┐рждрзЗ рж░рзВржкрж╛ржирзНрждрж░
    function convertBanglaDigits(text) {
      return text.replace(/[рзж-рзп]/g, d => banglaDigits[d] || d);
    }

    // ржЗржиржкрзБржЯрзЗржУ ржмрж╛ржВрж▓рж╛ ржбрж┐ржЬрж┐ржЯ рж░рзВржкрж╛ржирзНрждрж░ (ржпрж╛ userInput ржерзЗржХрзЗ ржирзЗржмрзЗ)
    function convertBanglaInputToEnglishDigits(input) {
      return input.replace(/[рзж-рзп]/g, d => banglaDigits[d] || d);
    }

    // ржмрж╛ржВрж▓рж╛ ржЕржкрж╛рж░рзЗржЯрж░ ржУ ржХрзАржУрзЯрж╛рж░рзНржб ржЧрзБрж▓рзЛ ржЗржВрж░рзЗржЬрж┐рждрзЗ рж░рзВржкрж╛ржирзНрждрж░
    function replaceOperators(text) {
      const keysSorted = Object.keys(mapC).sort((a,b) => b.length - a.length);
      for (const key of keysSorted) {
        const val = mapC[key];
        const re = new RegExp(`(?<!\\w)${key}(?!\\w)`, 'g');
        text = text.replace(re, val);
      }
      return text;
    }

    // рж╕ржорзНржкрзВрж░рзНржг ржмрж╛ржВрж▓рж╛ ржХрзЛржб ржерзЗржХрзЗ C ржХрзЛржб рждрзИрж░рж┐рж░ ржлрж╛ржВрж╢ржи
    function translateBanglaToC(code) {
      let lines = code.split('\n');
      let cCode = `#include <stdio.h>\nint main() {\n`;
      lines.forEach(line => {
        line = convertBanglaDigits(line);
        line = replaceOperators(line);
        cCode += "  " + line + "\n";
      });
      cCode += "  return 0;\n}";
      return cCode;
    }

    // рж░рж╛ржи ржХрж░рж╛рж░ ржкрзНрж░ржзрж╛ржи ржлрж╛ржВрж╢ржи
    function runBanglaCCode() {
      const banglaCode = document.getElementById("banglaCode").value;

      // ржЗржЙржЬрж╛рж░рзЗрж░ ржЗржиржкрзБржЯ ржерзЗржХрзЗ ржмрж╛ржВрж▓рж╛ ржбрж┐ржЬрж┐ржЯ ржЗржВрж░рзЗржЬрж┐рждрзЗ ржХржиржнрж╛рж░рзНржЯ ржХрж░рж╛
      const userInputRaw = document.getElementById("userInput").value;
      const userInput = convertBanglaInputToEnglishDigits(userInputRaw);

      const translatedCode = translateBanglaToC(banglaCode);
      document.getElementById("debug").textContent = translatedCode;
      document.getElementById("output").textContent = "тП│ рж░рж╛ржи рж╣ржЪрзНржЫрзЗ...";

      fetch("https://emkc.org/api/v2/piston/execute", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          language: "c",
          version: "10.2.0",
          files: [{ name: "main.c", content: translatedCode }],
          stdin: userInput
        })
      })
      .then(res => res.json())
      .then(data => {
        let output = data.run?.stdout || data.run?.stderr || "тЪая╕П ржХрзЛржирзЛ ржЖржЙржЯржкрзБржЯ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯржирж┐ред";
        document.getElementById("output").textContent = output.trim();
      })
      .catch(err => {
        document.getElementById("output").textContent = "тЭМ рждрзНрж░рзБржЯрж┐: " + err.message;
      });
    }

    // рж╕ржм ржлрж┐рж▓рзНржб ржХрзНрж▓рж┐рзЯрж╛рж░ ржХрж░рж╛рж░ ржЬржирзНржп
    function clearAll() {
      document.getElementById("banglaCode").value = "";
      document.getElementById("userInput").value = "";
      document.getElementById("output").textContent = "ржПржЦрж╛ржирзЗ ржЖржЙржЯржкрзБржЯ ржЖрж╕ржмрзЗ...";
      document.getElementById("debug").textContent = "...";
    }
  </script>
</body>
</html>
