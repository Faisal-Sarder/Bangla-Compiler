<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <title>‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶ï‡¶Æ‡ßç‡¶™‡¶æ‡¶á‡¶≤‡¶æ‡¶∞</title>

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Noto Sans Bengali', sans-serif;
      padding: 40px 20px;
      max-width: 960px;
      margin: auto;
      border-radius: 10px;
      transition: background 0.3s, color 0.3s;
    }

    body.light {
      background: #f4f6f9;
      color: #1a1a1a;
    }

    body.dark {
      background: #1a1a1a;
      color: #eaeaea;
    }

    h1 {
      font-size: 32px;
      margin-bottom: 10px;
    }

    h3 {
      font-size: 20px;
      margin-top: 30px;
      margin-bottom: 10px;
      border-left: 4px solid #007bff;
      padding-left: 10px;
    }

    label {
      font-weight: bold;
      display: block;
      margin-top: 25px;
      font-size: 17px;
    }

    textarea {
      width: 100%;
      height: 160px;
      font-size: 15px;
      margin-top: 8px;
      padding: 12px 15px;
      border: 1px solid #ccc;
      border-radius: 8px;
      background-color: #fff;
      resize: vertical;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
      transition: border-color 0.3s, background-color 0.3s, color 0.3s;
    }

    textarea:focus {
      border-color: #007bff;
      outline: none;
    }

    button {
      margin: 10px 8px 0 0;
      padding: 12px 24px;
      background-color: #007bff;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s;
    }

    button:hover {
      background-color: #0056b3;
      transform: translateY(-1px);
    }

    pre {
      background-color: #1e1e1e;
      color: #d4d4d4;
      padding: 18px;
      border-radius: 8px;
      white-space: pre-wrap;
      font-size: 15px;
      overflow-x: auto;
      line-height: 1.6;
      box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
      transition: background-color 0.3s, color 0.3s;
    }

    body.dark textarea,
    body.dark button,
    body.dark pre {
      background-color: #2b2b2b;
      color: #eaeaea;
      border-color: #444;
    }

    body.dark pre {
      box-shadow: inset 0 0 6px rgba(255,255,255,0.1);
    }

    body.dark button {
      background-color: #0d6efd;
    }

    body.dark button:hover {
      background-color: #0b5ed7;
    }

    body.dark h1, body.dark h3, body.dark label {
      color: #ddd;
    }

    ::selection {
      background: #007bff;
      color: white;
    }

    @media (max-width: 600px) {
      textarea { height: 140px; }
      button { width: 100%; margin-bottom: 10px; }
    }
  </style>
</head>

<body class="light">
  <!-- üåô Dark/Light Mode Toggle -->
  <div style="text-align: right; margin-bottom: 20px;">
    <label>
      ‚óë Dark Mode
      <input type="checkbox" id="toggleMode" onchange="toggleMode()" style="transform: scale(1.2); margin-left: 8px;">
    </label>
  </div>

  <h1>üñ•Ô∏è ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶ï‡¶Æ‡ßç‡¶™‡¶æ‡¶á‡¶≤‡¶æ‡¶∞</h1>

  <label>‚úçÔ∏è ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ C ‡¶ï‡ßã‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®:</label>
  <textarea id="banglaCode" placeholder="‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ C ‡¶™‡ßç‡¶∞‡ßã‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡¶ø‡¶Ç ‡¶ï‡ßã‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..."></textarea>

  <label>üì• ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶¶‡¶ø‡¶® (‡¶Ø‡¶¶‡¶ø ‡¶•‡¶æ‡¶ï‡ßá):</label>
  <textarea id="userInput" placeholder="‡¶Ø‡¶¶‡¶ø ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶•‡¶æ‡¶ï‡ßá, ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡¶ø‡¶®..."></textarea>

  <div>
    <button onclick="runBanglaCCode()">‚ñ∂Ô∏è ‡¶∞‡¶æ‡¶® ‡¶ï‡¶∞‡ßã</button>
    <button onclick="clearAll()">üßπ ‡¶™‡¶∞‡¶ø‡¶∑‡ßç‡¶ï‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßã</button>
  </div>

  <h3>üì§ ‡¶Ü‡¶â‡¶ü‡¶™‡ßÅ‡¶ü:</h3>
  <pre id="output">‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶â‡¶ü‡¶™‡ßÅ‡¶ü ‡¶Ü‡¶∏‡¶¨‡ßá...</pre>

  <h3>üîé ‡¶∞‡ßÇ‡¶™‡¶æ‡¶®‡ßç‡¶§‡¶∞‡¶ø‡¶§ C ‡¶ï‡ßã‡¶°:</h3>
  <pre id="debug">...</pre>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      document.body.className = "light";
    });

    function toggleMode() {
      const isDark = document.getElementById("toggleMode").checked;
      document.body.className = isDark ? "dark" : "light";
    }

    const mapC = {
      "‡¶≤‡¶ø‡¶ñ‡ßã": "printf",
      "‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ_‡¶®‡¶æ‡¶ì": "scanf",
      "‡¶Ø‡¶¶‡¶ø": "if",
      "‡¶®‡¶æ‡¶π‡¶≤‡ßá": "else",
      "‡¶ú‡¶®‡ßç‡¶Ø": "for",
      "‡¶Ø‡¶§‡¶ï‡ßç‡¶∑‡¶£": "while",
      "‡¶´‡¶æ‡¶Ç‡¶∂‡¶®": "void",
      "‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡¶æ‡¶¨‡¶∞‡ßç‡¶§‡¶®": "return",
      "‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ": "int",
      "‡¶≠‡¶ó‡ßç‡¶®‡¶æ‡¶Ç‡¶∂": "float",
      "‡¶ö‡¶∞": "char",
      "‡¶Æ‡ßÇ‡¶≤": "main",
      "‡¶∏‡¶Æ‡¶æ‡¶®": "==",
      "‡¶®‡¶æ_‡¶∏‡¶Æ‡¶æ‡¶®": "!=",
      "‡¶¨‡¶°‡¶º": ">",
      "‡¶õ‡ßã‡¶ü": "<",
      "‡¶è‡¶¨‡¶Ç": "&&",
      "‡¶Ö‡¶•‡¶¨‡¶æ": "||"
    };

    const banglaDigits = {
      "‡ß¶": "0", "‡ßß": "1", "‡ß®": "2", "‡ß©": "3", "‡ß™": "4",
      "‡ß´": "5", "‡ß¨": "6", "‡ß≠": "7", "‡ßÆ": "8", "‡ßØ": "9"
    };

    const englishToBanglaDigits = {
      "0": "‡ß¶", "1": "‡ßß", "2": "‡ß®", "3": "‡ß©", "4": "‡ß™",
      "5": "‡ß´", "6": "‡ß¨", "7": "‡ß≠", "8": "‡ßÆ", "9": "‡ßØ"
    };

    const banglaToEnglishText = {
      "‡¶´‡¶≤‡¶æ‡¶´‡¶≤": "Result",
      "‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ": "Number",
      "‡¶Ø‡ßã‡¶ó‡¶´‡¶≤": "Sum",
      "‡¶®‡¶æ‡¶Æ": "Name",
      "‡¶á‡¶®‡¶™‡ßÅ‡¶ü": "Input",
      "‡¶Ü‡¶â‡¶ü‡¶™‡ßÅ‡¶ü": "Output"
    };

    function convertBanglaDigitsToEnglish(text) {
      return text.replace(/[‡ß¶-‡ßØ]/g, d => banglaDigits[d] || d);
    }

    function convertEnglishDigitsToBangla(text) {
      return text.replace(/\d/g, d => englishToBanglaDigits[d] || d);
    }

    function replaceOperators(text) {
      const keysSorted = Object.keys(mapC).sort((a, b) => b.length - a.length);
      for (const key of keysSorted) {
        const val = mapC[key];
        const re = new RegExp(`(?<!\\w)${key}(?!\\w)`, 'g');
        text = text.replace(re, val);
      }
      return text;
    }

    function translateBanglaToC(code) {
      let lines = code.split('\n');
      let cCode = `#include <stdio.h>\nint main() {\n`;
      lines.forEach(line => {
        line = convertBanglaDigitsToEnglish(line);
        line = replaceOperators(line);

        line = line.replace(/"(.*?)"/g, (match, content) => {
          let newContent = content;
          for (const key in banglaToEnglishText) {
            newContent = newContent.replace(new RegExp(key, 'g'), banglaToEnglishText[key]);
          }
          return `"${newContent}"`;
        });

        cCode += "  " + line + "\n";
      });
      cCode += "  return 0;\n}";
      return cCode;
    }

    function runBanglaCCode() {
      const banglaCode = document.getElementById("banglaCode").value;
      const userInputRaw = document.getElementById("userInput").value;
      const userInput = convertBanglaDigitsToEnglish(userInputRaw);

      const translatedCode = translateBanglaToC(banglaCode);
      document.getElementById("debug").textContent = translatedCode;
      document.getElementById("output").textContent = "‚è≥ ‡¶∞‡¶æ‡¶® ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";

      fetch("https://emkc.org/api/v2/piston/execute", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          language: "c",
          version: "10.2.0",
          files: [{ name: "main.c", content: translatedCode }],
          stdin: userInput
        })
      })
      .then(res => res.json())
      .then(data => {
        let raw = data.run?.stdout || data.run?.stderr || "‚ö†Ô∏è ‡¶ï‡ßã‡¶®‡ßã ‡¶Ü‡¶â‡¶ü‡¶™‡ßÅ‡¶ü ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§";
        let converted = convertEnglishDigitsToBangla(raw);
        for (const key in banglaToEnglishText) {
          const eng = banglaToEnglishText[key];
          const bn = key;
          const regex = new RegExp(eng, 'g');
          converted = converted.replace(regex, bn);
        }

        document.getElementById("output").textContent = converted.trim();
      })
      .catch(err => {
        document.getElementById("output").textContent = "‚ùå ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: " + err.message;
      });
    }

    function clearAll() {
      document.getElementById("banglaCode").value = "";
      document.getElementById("userInput").value = "";
      document.getElementById("output").textContent = "‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶â‡¶ü‡¶™‡ßÅ‡¶ü ‡¶Ü‡¶∏‡¶¨‡ßá...";
      document.getElementById("debug").textContent = "...";
    }
  </script>
</body>
</html>
