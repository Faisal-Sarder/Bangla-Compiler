<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <title>ржмрж╛ржВрж▓рж╛ ржХржорзНржкрж╛ржЗрж▓рж╛рж░</title>
  <style>
    body {
      font-family: 'Noto Sans Bengali', sans-serif;
      background: #eef1f4;
      padding: 20px;
      max-width: 900px;
      margin: auto;
    }
    textarea {
      width: 100%;
      height: 160px;
      font-size: 16px;
      margin-top: 8px;
      padding: 10px;
      border-radius: 5px;
    }
    button {
      margin: 5px;
      padding: 10px 18px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 15px;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    pre {
      background-color: #111;
      color: #0f0;
      padding: 15px;
      border-radius: 5px;
      white-space: pre-wrap;
    }
    h1, h3 {
      color: #333;
    }
  </style>
</head>
<body>

  <h1>ЁЯФд ржмрж╛ржВрж▓рж╛ ржХржорзНржкрж╛ржЗрж▓рж╛рж░</h1>

  <label>тЬНя╕П ржмрж╛ржВрж▓рж╛ C ржХрзЛржб рж▓рж┐ржЦрзБржи:</label>
  <textarea id="banglaCode" placeholder="ржПржЦрж╛ржирзЗ ржмрж╛ржВрж▓рж╛ C ржкрзНрж░рзЛржЧрзНрж░рж╛ржорж┐ржВ ржХрзЛржб рж▓рж┐ржЦрзБржи..."></textarea>

  <label>ЁЯУе ржЗржиржкрзБржЯ ржжрж┐ржи (ржпржжрж┐ ржерж╛ржХрзЗ):</label>
  <textarea id="userInput" placeholder="ржпржжрж┐ ржЗржиржкрзБржЯ ржерж╛ржХрзЗ, ржПржЦрж╛ржирзЗ ржжрж┐ржи... (ржмрж╛ржВрж▓рж╛ рж╕ржВржЦрзНржпрж╛ржУ ржЪрж▓ржмрзЗ)"></textarea>

  <div>
    <button onclick="runBanglaCCode()">тЦ╢я╕П рж░рж╛ржи ржХрж░рзЛ</button>
    <button onclick="clearAll()">ЁЯз╣ ржкрж░рж┐рж╖рзНржХрж╛рж░ ржХрж░рзЛ</button>
  </div>

  <h3>ЁЯУд ржЖржЙржЯржкрзБржЯ:</h3>
  <pre id="output">ржПржЦрж╛ржирзЗ ржЖржЙржЯржкрзБржЯ ржЖрж╕ржмрзЗ...</pre>

  <h3>ЁЯФО рж░рзВржкрж╛ржирзНрждрж░рж┐ржд C ржХрзЛржб:</h3>
  <pre id="debug">...</pre>

  <script>
    const mapC = {
      "рж▓рж┐ржЦрзЛ": "printf",
      "рж╕ржВржЦрзНржпрж╛_ржирж╛ржУ": "scanf",
      "ржпржжрж┐": "if",
      "ржирж╛рж╣рж▓рзЗ": "else",
      "ржЬржирзНржп": "for",
      "ржпрждржХрзНрж╖ржг": "while",
      "ржлрж╛ржВрж╢ржи": "void",
      "ржкрзНрж░рждрзНржпрж╛ржмрж░рзНрждржи": "return",
      "ржкрзВрж░рзНржгрж╕ржВржЦрзНржпрж╛": "int",
      "ржнржЧрзНржирж╛ржВрж╢": "float",
      "ржЪрж░": "char",
      "ржорзВрж▓": "main",
      "рж╕ржорж╛ржи": "==",
      "ржирж╛_рж╕ржорж╛ржи": "!=",
      "ржмржбрж╝": ">",
      "ржЫрзЛржЯ": "<",
      "ржПржмржВ": "&&",
      "ржЕржержмрж╛": "||"
    };

    const banglaDigits = {
      "рзж": "0", "рзз": "1", "рзи": "2", "рзй": "3", "рзк": "4",
      "рзл": "5", "рзм": "6", "рзн": "7", "рзо": "8", "рзп": "9"
    };

    const englishToBanglaDigits = {
      "0": "рзж", "1": "рзз", "2": "рзи", "3": "рзй", "4": "рзк",
      "5": "рзл", "6": "рзм", "7": "рзн", "8": "рзо", "9": "рзп"
    };

    const banglaToEnglishText = {
      "ржлрж▓рж╛ржлрж▓": "Result",
      "рж╕ржВржЦрзНржпрж╛": "Number",
      "ржпрзЛржЧржлрж▓": "Sum",
      "ржирж╛ржо": "Name",
      "ржЗржиржкрзБржЯ": "Input",
      "ржЖржЙржЯржкрзБржЯ": "Output"
    };

    function convertBanglaDigitsToEnglish(text) {
      return text.replace(/[рзж-рзп]/g, d => banglaDigits[d] || d);
    }

    function convertEnglishDigitsToBangla(text) {
      return text.replace(/\d/g, d => englishToBanglaDigits[d] || d);
    }

    function replaceOperators(text) {
      const keysSorted = Object.keys(mapC).sort((a, b) => b.length - a.length);
      for (const key of keysSorted) {
        const val = mapC[key];
        const re = new RegExp(`(?<!\\w)${key}(?!\\w)`, 'g');
        text = text.replace(re, val);
      }
      return text;
    }

    function translateBanglaToC(code) {
      let lines = code.split('\n');
      let cCode = `#include <stdio.h>\nint main() {\n`;
      lines.forEach(line => {
        line = convertBanglaDigitsToEnglish(line);
        line = replaceOperators(line);

        // рж╢рзБржзрзБ рж░рзВржкрж╛ржирзНрждрж░рж┐ржд C ржХрзЛржбрзЗ рж╕рзНржЯрзНрж░рж┐ржВ ржмрж╛ржВрж▓рж╛рж░ рж╢ржмрзНржж тЖТ ржЗржВрж░рзЗржЬрж┐
        line = line.replace(/"(.*?)"/g, (match, content) => {
          let newContent = content;
          for (const key in banglaToEnglishText) {
            newContent = newContent.replace(new RegExp(key, 'g'), banglaToEnglishText[key]);
          }
          return `"${newContent}"`;
        });

        cCode += "  " + line + "\n";
      });
      cCode += "  return 0;\n}";
      return cCode;
    }

    function runBanglaCCode() {
      const banglaCode = document.getElementById("banglaCode").value;
      const userInputRaw = document.getElementById("userInput").value;
      const userInput = convertBanglaDigitsToEnglish(userInputRaw);

      const translatedCode = translateBanglaToC(banglaCode);
      document.getElementById("debug").textContent = translatedCode;
      document.getElementById("output").textContent = "тП│ рж░рж╛ржи рж╣ржЪрзНржЫрзЗ...";

      fetch("https://emkc.org/api/v2/piston/execute", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          language: "c",
          version: "10.2.0",
          files: [{ name: "main.c", content: translatedCode }],
          stdin: userInput
        })
      })
      .then(res => res.json())
      .then(data => {
        let raw = data.run?.stdout || data.run?.stderr || "тЪая╕П ржХрзЛржирзЛ ржЖржЙржЯржкрзБржЯ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ржирж┐ред";
        let converted = convertEnglishDigitsToBangla(raw);

        // ржЖржЙржЯржкрзБржЯрзЗ ржЗржВрж░рзЗржЬрж┐ тЖТ ржмрж╛ржВрж▓рж╛ (рж╢ржмрзНржж)
        for (const key in banglaToEnglishText) {
          const eng = banglaToEnglishText[key];
          const bn = key;
          const regex = new RegExp(eng, 'g');
          converted = converted.replace(regex, bn);
        }

        document.getElementById("output").textContent = converted.trim();
      })
      .catch(err => {
        document.getElementById("output").textContent = "тЭМ рждрзНрж░рзБржЯрж┐: " + err.message;
      });
    }

    function clearAll() {
      document.getElementById("banglaCode").value = "";
      document.getElementById("userInput").value = "";
      document.getElementById("output").textContent = "ржПржЦрж╛ржирзЗ ржЖржЙржЯржкрзБржЯ ржЖрж╕ржмрзЗ...";
      document.getElementById("debug").textContent = "...";
    }
  </script>
</body>
</html>
